<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Find Pharmacies - AreaHealth</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-sky-50 min-h-screen">

  <!-- Header -->
  <header class="bg-sky-600 text-white p-4 shadow-md">
    <h1 class="text-2xl font-bold text-center">Find Pharmacies Near You ðŸ’Š</h1>
  </header>

  <!-- Search Bar -->
  <div class="flex justify-center mt-6">
    <input
      id="searchInput"
      type="text"
      placeholder="Search pharmacy name or location..."
      class="w-3/4 md:w-1/2 p-3 border border-sky-400 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500"
    />
  </div>

  <!-- Pharmacy List -->
  <section id="pharmacyList" class="mt-8 px-4 grid gap-4 md:grid-cols-2 lg:grid-cols-3">
    <!-- Pharmacies will appear here -->
  </section>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";

    // âœ… Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyC79cSDPpC4bbhlRBpu7WhON3j8AMxMLyE",
      authDomain: "areahealth-ng.firebaseapp.com",
      projectId: "areahealth-ng",
      storageBucket: "areahealth-ng.appspot.com",
      messagingSenderId: "986651954303",
      appId: "1:986651954303:web:3f38dc24e246b7047d834a"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const pharmacyList = document.getElementById("pharmacyList");
    const searchInput = document.getElementById("searchInput");

    // âœ… Local Data (No Firebase Fetch)
    const pharmacies = [
      {
        id: "pharma1",
        name: "HealthPlus Pharmacy",
        location: "Yenagoa",
        contact: "08012345678",
        email: "info@healthplus.com",
        hours: "8am - 9pm",
        drugs: ["Paracetamol", "Amoxicillin", "Insulin"],
        services: "Dispensing, Counseling, BP Check",
        about: "Providing quality pharmaceutical care in Yenagoa."
      },
      {
        id: "pharma2",
        name: "MedCare Pharmacy",
        location: "Ogbia Town",
        contact: "08123456789",
        email: "contact@medcare.com",
        hours: "7am - 10pm",
        drugs: ["Ibuprofen", "Cough Syrup", "Vitamin C"],
        services: "OTC Sales, Health Advice, Vaccinations",
        about: "Community pharmacy committed to patient care."
      },
      {
        id: "pharma3",
        name: "LifeLine Pharmacy",
        location: "Opolo, Yenagoa",
        contact: "07034567890",
        email: "lifeline@pharm.com",
        hours: "24 Hours",
        drugs: ["Antibiotics", "Antimalarials", "Supplements"],
        services: "24/7 Service, Delivery, Drug Counseling",
        about: "Open round the clock for your health needs."
      },
      {
        id: "pharma4",
        name: "CityCare Pharmacy",
        location: "Etegwe",
        contact: "09056789012",
        email: "citycare@pharm.com",
        hours: "8am - 8pm",
        drugs: ["Insulin", "Painkillers", "BP Drugs"],
        services: "Consultation, Dispensing, Follow-up",
        about: "Trusted pharmacy for chronic care management."
      },
      {
        id: "pharma5",
        name: "Wellness Drug Store",
        location: "Amassoma",
        contact: "08109876543",
        email: "wellness@pharmacy.com",
        hours: "9am - 6pm",
        drugs: ["Supplements", "Cold Meds", "Antacids"],
        services: "Nutrition Advice, OTC Drugs",
        about: "Focused on wellness and preventive health."
      },
      {
        id: "pharma6",
        name: "Bayelsa Pharma Hub",
        location: "Ekeki",
        contact: "08023456789",
        email: "bayelsahub@pharm.com",
        hours: "8am - 9pm",
        drugs: ["All categories"],
        services: "Wholesale & Retail, Counseling",
        about: "Your one-stop pharmacy hub in Bayelsa."
      },
      {
        id: "pharma7",
        name: "Royal Care Pharmacy",
        location: "Akenfa",
        contact: "09098765432",
        email: "royalcare@pharm.com",
        hours: "7am - 8pm",
        drugs: ["Malaria drugs", "Cough Syrup", "Vitamins"],
        services: "Consultation, Counseling, Home Delivery",
        about: "Royal care for royal health."
      },
      {
        id: "pharma8",
        name: "Grace Pharmacy",
        location: "Tombia Road",
        contact: "08155667788",
        email: "grace@pharmacy.com",
        hours: "9am - 7pm",
        drugs: ["OTC Drugs", "Supplements"],
        services: "Sales, Advice, Monitoring",
        about: "Serving with grace and professionalism."
      },
      {
        id: "pharma9",
        name: "Elite Pharmacy",
        location: "Biogbolo",
        contact: "08077889900",
        email: "elite@pharm.com",
        hours: "8am - 8pm",
        drugs: ["Antibiotics", "BP Drugs", "Insulin"],
        services: "BP Check, Counseling, Lab Test Booking",
        about: "Elite service, elite care."
      },
      {
        id: "pharma10",
        name: "Community Health Pharmacy",
        location: "Kpansia",
        contact: "07099887766",
        email: "community@pharmacy.com",
        hours: "8am - 9pm",
        drugs: ["Basic and prescription drugs"],
        services: "Health Education, Drug Dispensing",
        about: "Serving the community with care."
      }
    ];

    // ðŸ”’ Auth Check
    onAuthStateChanged(auth, (user) => {
      if (!user) {
        window.location.href = "AreaHealth Login.html";
      } else {
        console.log("âœ… Logged in as:", user.email);
        displayPharmacies(pharmacies);
      }
    });

    // ðŸ§  Search Functionality
    searchInput.addEventListener("input", () => {
      const query = searchInput.value.toLowerCase();
      const filtered = pharmacies.filter(
        (p) =>
          (p.name && p.name.toLowerCase().includes(query)) ||
          (p.location && p.location.toLowerCase().includes(query))
      );
      displayPharmacies(filtered);
    });

    // ðŸ§± Display Pharmacies
    function displayPharmacies(list) {
      pharmacyList.innerHTML = "";
      if (list.length === 0) {
        pharmacyList.innerHTML = `<p class="text-center text-sky-600 col-span-full">No pharmacies found.</p>`;
        return;
      }

      list.forEach((pharmacy) => {
        const card = document.createElement("div");
        card.className =
          "bg-white rounded-xl shadow-md p-5 hover:shadow-lg transition relative";

        card.innerHTML = `
          <h2 class="text-xl font-bold text-sky-700">${pharmacy.name}</h2>
          <p class="text-gray-600 mt-1"><strong>Location:</strong> ${pharmacy.location}</p>
          <p class="text-gray-600 mt-1"><strong>Contact:</strong> ${pharmacy.contact}</p>
          <button 
            class="mt-3 bg-sky-500 text-white px-4 py-2 rounded-lg hover:bg-sky-600 transition w-full"
            onclick="toggleDetails('${pharmacy.id}')">
            View Details
          </button>
          <div id="details-${pharmacy.id}" class="hidden mt-4 border-t pt-3 text-gray-700">
            <p><strong>Email:</strong> ${pharmacy.email}</p>
            <p><strong>Hours:</strong> ${pharmacy.hours}</p>
            <p><strong>Services:</strong> ${pharmacy.services}</p>
            <p class="mt-2"><strong>About:</strong> ${pharmacy.about}</p>
            <div class="mt-2">
              <strong>Available Drugs:</strong>
              <ul class="list-disc list-inside text-gray-600 mt-1">
                ${(pharmacy.drugs || []).map((d) => `<li>${d}</li>`).join("")}
              </ul>
            </div>
            <button 
              class="mt-3 bg-gray-300 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-400 transition w-full"
              onclick="toggleDetails('${pharmacy.id}')">
              Close Details
            </button>
          </div>
        `;
        pharmacyList.appendChild(card);
      });
    }

    // ðŸ”„ Toggle Details
    window.toggleDetails = function (id) {
      const details = document.getElementById(`details-${id}`);
      details.classList.toggle("hidden");
    };
  </script>
</body>
</html>
